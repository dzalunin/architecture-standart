### <a name="_b7urdng99y53"></a>**Название задачи: Открытие депозитов online** 
### <a name="_hjk0fkfyohdk"></a>**Автор:**
### <a name="_uanumrh8zrui"></a>**Дата:**
### <a name="_3bfxc9a45514"></a>**Функциональные требования**

Цель: Клиент может открыть депозит или накопительный счёт в интернет-банке. В MVP бэк-офис может обрабатывать заявки по старому процессу.
|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
| UC1 | Клиент банка, Интернет-банк, СМС-Шлюз, АБС | В интернет-банке клиент подает заявку на депозит, указав счёт и сумму | 1. Клиент авторизуется в интернет банке. <br>2. Клиент выбирает тип депозита, счет, сумму. <br>3. Клиент подтверждает открытие депозита по СМС. <br>4. Заявка на открытие депозита передается в АБС |
| UC2 | Сотрудник бэк-офиса, АБС, СМС-шлюз | Сотрудник бэк-офиса подтверждает ставку и открытие депозита в АБС | 1. Сотрудник бэк-офиса получает заявку в АБС. <br>2. Сотрудник бэк-офиса обрабатывает заявку в АБС, подтверждает открытие депозита, ставку. <br>3.Клиент получает СМС со статусом |
| UC3 | Пользователь, Система call-центра, АБС | Новый клиент подает заявку на депозит | 1. Пользователь переходит в раздел с депозитами. При этом выполняется актуализация ставок. <br>2. Пользователь просматривает актуальные продукты. <br>3. Пользователь выбирает интересующий депозит, заполняет ФИО, номер телефона, отправляет заявку на открытие депозита. <br>4. Заявка выгружается в систему call-центра |
| UC4 | Пользователь, Оператор call-центра, Система call-центра | Обработка заявки на открытие депозита с сайта |1. Оператор видит заявку на открытие депозита. <br>2. Оператор связывается с новый клиентом, предлагает посетить офис для подтверждения документов |

### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**

|**№**|**Требование**|
| :-: | :- |
| R1   | Доступность интернет-банка и сайта не менее 99,9%, 24/7 |
| R2   | СМС-уведомления должны приходить всегда, даже при сбоях |
| R3   | Избегать прямой работы интернет-банка с API АБС |
| R4   | Предусмотреть возможность переключения на резервный ЦОД |
| R5   | Горизонтальное масштабирование новых сервисов | 
| P1   | Время отклика интерфейса < 1 сек |
| P2   | Время загрузки справочников < 0,5 сек |
| S1   | Использование существующих технологий (MS SQL, Oracle, .NET, React)|
| S2   | Документированная архитектура и API |
| +R1  | Шифрование трафика (TLS) при передаче данных |
| +R2  | Централизованное хранение ставок в АБС |
| +R3  | Kafka не совместима с текущей версией интернет банка |
| +R4  | Только вертикальное масштабирование для АБС |

### <a name="_qmphm5d6rvi3"></a>**Решение**

[Диаграмма контекста](./context.puml)  
[Диаграмма контейнеров](./containers.puml)

- АБС и СМС-шлюз оставлены как монолиты (в рамках MVP)
- Взаимодействие сайта и интернет банка с АБС выполняется асинхронно.
- Для централизованного управления расчетом ставок создан отдельный сервис. Ставки сначала могут приходить из XLS, затем — из АБС или через UI.
- Пользовательская документация для компонентов инфраструктуры ведется в формате rst, при сборке релиза конвертируется в статику, встраивается в приложения.
- Документация API ведется в swagger, встраивается в backend при сборке. Документация для разработчиков генерируется при сборке, текстоные описания классов и методов получаем из докстрингов.

### <a name="_bjrr7veeh80c"></a>**Альтернативы**
- От выделения расчета ставок в отдельный сервис можно было отказаться и расширить функционал АБС, но тогда возроста бы нагрузка на критические важную и сложно масштабируемую ИС.

**Недостатки, ограничения, риски**

- АБС можно масштабировать только вертикально. Соответвтенно затруднительно динамически регулировать ресурсы в зависимости от нагрузки.
